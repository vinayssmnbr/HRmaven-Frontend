<app-sidebar></app-sidebar>
<app-header></app-header>
<div class="main">
  <div class="selection">
    <div class="list_nav">
      <div class="All" [ngClass]="{'active': isallactive}">
        <p (click)="isall()">All</p>
      </div>
      <div class="Active" [ngClass]="{'active': is_active}">
        <p (click)="isactive()">Active</p>
      </div>
      <div class="Resigned" [ngClass]="{'active':is_resigned}">
        <p (click)="isresigned()">Resigned</p>
      </div>
      <div class="Terminated" [ngClass]="{'active':is_terminated}">
        <p (click)="isterminated()">Terminated</p>
      </div>
      <div class="Absconder" [ngClass]="{'active':is_absconder}">
        <p (click)="isabsconder()">Absconder</p>
      </div>
    </div>

  </div>
  <div class="selection2">
    <div class="input_left">
      <div class="input_field">
        <input type="text" class="number1 no-spin" placeholder="Enter Employee Name or ID" [(ngModel)]="query"
          id="search">
        <i class="fa-solid fa-magnifying-glass"></i>
      </div>

      <div class="dropdown_content" (mouseleave)="contentdropdown = false">
        <div class="dropdwon_select" (click)="dropdownOpen()">
          <div class="drop-icon">
            <p>{{Selectvariable}}</p>
            <div class="input_icon">
              <i class="fa-sharp fa-solid fa-caret-down"></i>
            </div>
          </div>
        </div>
        <div class="select_content" *ngIf="contentdropdown" (mouseleave)="dropdownClose()">
          <ul>
            <li *ngFor="let arr of array; index as i" [class.select_active]="i === colorvariable"
              (click)="Changeselect(arr)">
              {{arr.name}}</li>
          </ul>
        </div>
      </div>
    </div>
    <div class="input_right">
      <div class="view">
        <i class="fa-solid fa-list"></i>
        <img src="./assets/images/Vector (1).svg" alt="">
      </div>
      <button class="import" (click)="download()"><img src="./assets/images/prime_file-import.svg">Export</button>
      <button class="import" (click)="openImport()"><img src="./assets/images/prime_file-export.svg">Import</button>
      <button class="btn3" (click)="openModal()"><i class="fa-solid fa-circle-plus"></i>Add Employee</button>
    </div>
  </div>

  <div class="table-wrapper">
    <table>
      <thead>
        <tr class="table-row">
          <th class="employee"><input type="checkbox" (change)="onCheckboxChange($event, 'All')" >Employee ID</th>
          <!-- <th class="employee"><input type="checkbox"  [(ngModel)]=" isChecked"  (change)="onCheckboxChange($event, 'All')" >Employee ID</th> -->
          <th class="name">Name</th>
          <th class="email">Designation</th>
          <th class="designation">Email</th>
          <th class="action">Contact</th>
          <th class="contact">Status</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let user of employee | employeefilter:query:Selectvariable " >
          <!--  -->
          <td style="text-align:center; background-color: transparent;" colspan="7" class="nodata" class="no_data"
            *ngIf="user.found=='true'">
            <p style="text-align:center;"> <img src="assets/images/no_record.png" alt="" class="center"></p>
            <h2>No Record Found!</h2>
          </td>

          <td *ngIf="user.found!='true'">
            <div class="employee1"><input type="checkbox" [value]="user.id" [checked]="user.checked"
                (change)="onCheckboxChange($event, user)">{{user.uid}}</div>
            <!-- <div class="employee1"><input type="checkbox" [ngModel]=" isChecked" (click)="toggleAllCheckboxes()" [value]="user.id" [checked]="user.select" (change)="onCheckboxChange($event, user)">{{user.uid}}</div> -->
          </td>

          <td *ngIf="user.found!='true'" class="name1" (click)="selectEmployee(user)" routerLink="/employee-profile">
            <img *ngIf="!user.url" src="./assets/images/Ellipse 98.svg" alt="" (click)="selectEmployee(user)"
              routerLink="/employee-profile">
              <img *ngIf="user.url" src="{{user.url}}" alt="" (click)="selectEmployee(user)"
              routerLink="/employee-profile">{{user.name}}
          </td>
          <td *ngIf="user.found!='true'" class="designation1" (click)="selectEmployee(user)"
            routerLink="/employee-profile">{{user.designation}}</td>
          <td *ngIf="user.found!='true'" class="email1" (click)="selectEmployee(user)" routerLink="/employee-profile">
            {{user.email}}</td>
          <td *ngIf="user.found!='true'" class="contact1" (click)="selectEmployee(user)" routerLink="/employee-profile">
            {{user.mobile}}</td>
          <td *ngIf="user.found!='true'" class="action1">
            <div class="icons">
              <select class="select" id="myselect" [class.active]="user.status==='active'" [disabled]="isSelectDisabled"
                (change)="onSelectChange($event, user)" [value]="user.status"
                [ngStyle]="selectedUser === user._id ? optionStyle : getStatusStyle(user)">
                <option value="active" class="activated">Active</option>
                <option value="terminated" class="terminate">Terminated</option>
                <option value="resigned" class="resign">Resigned</option>
                <option value="absconder" class="abscond">Absconder</option>
              </select>
            </div>
          </td>
        </tr>
      </tbody>

    </table>
  </div>
  <div class="modal" *ngIf="showModal">
    <div class="modal-content" *ngIf="showModalContent">
      <div class="modal-header">
        <div class="header-title">
          <h4 class="modal-title">Add New Employee</h4>
        </div>
        <div class="details_row">
          <span [ngClass]="{'active':firstStep,'inactive':!firstStep}">
            <p>1. General Details</p>
          </span>
          <span [ngClass]="{'active':secondStep,'inactive':!secondStep}">
            <p>2. Job Details</p>
          </span>
        </div>
        <i class="fa-solid fa-xmark" (click)="closeModal()"></i>
      </div>
      <div class="modal-body">

        <form class="form-container" id="form1" [formGroup]="form" *ngIf="firstStep" (ngSubmit)="submit()">
          <div class="form-row">
            <div class="input">
              <label>Name</label>
              <input type="name" id="text1" placeholder="Zana Jones" formControlName="name" (keydown)="Space($event)"
                [ngClass]="{'ng_invalid': registrationFormControl.name.invalid && registrationFormControl.name.dirty,'ng_valid': registrationFormControl.name.valid}">
            </div>
            <div class="input">
              <label>Job Type</label>
              <div class="dropdown_container" (mouseleave)="contentdropdown1 = false">
                <div class="dropdwon_select" (click)="dropdownOpen1()" id="slt1">
                  <!-- <p>{{Selectvariable1}}</p> -->
                  <input type="text" [(ngModel)]="Selectvariable1" formControlName="job_type" id="text9"
                    placeholder="Select" readonly>
                  <span><i class="fa-sharp fa-solid fa-caret-down"></i></span>
                </div>
                <div class="select_content1" *ngIf="contentdropdown1" (mouseleave)="dropdownClose1()">
                  <ul>
                    <li *ngFor="let arr1 of array1; index as i" [class.select_active]="i === colorvariable1"
                      (click)="Changeselect1(arr1)">
                      {{arr1.name}}</li>
                  </ul>
                </div>
              </div>
            </div>

          </div>
          <div class="form-row">
            <div class="input">
              <label>Designation</label>
              <div class="dropdown_container" (mouseleave)="contentdropdown3 = false">
                <div class="dropdwon_select" (click)="dropdownOpen3()" id="slt1">

                  <input type="text" [(ngModel)]="Selectvariable6" formControlName="designation" id="text8"
                    placeholder="Select" readonly>
                  <span><i class="fa-sharp fa-solid fa-caret-down"></i></span>
                </div>
                <div class="select_content1" *ngIf="contentdropdown3" (mouseleave)="dropdownClose3()">
                  <ul>
                    <li *ngFor="let arr6 of array6; index as i" [class.select_active]="i === colorvariable6"
                      (click)="Changeselect6(arr6)">
                      {{arr6.name}}</li>
                  </ul>
                </div>
              </div>
            </div>
            <div class="input">
              <label>Profile Picture</label>
              <div class="custom-file-picker">
                <input type="text" placeholder="No File Choosen" (click)="fileInput.click()"  [value]="fileName" id="text4" readonly accept="image/*" formControlName="url" >
                <input type="file" #fileInput (change)="onFileSelected($event)" formControlName="url" accept="image/*">
                <a  (click)="fileInput.click()" >Choose File</a>
              </div>
            </div>
          </div>
          <div class="form-row">
            <div class="input">
              <label>Personal Email </label>
              <input type="email" id="text7" placeholder="zones123@gmail.com" formControlName="email"
                (keydown)="validateEmail($event)"
                [ngClass]="{'ng_invalid': registrationFormControl.email.invalid && registrationFormControl.email.dirty,'ng_valid': registrationFormControl.email.valid}">

            </div>
            <div class="input">
              <label>Mobile No.</label>
              <input type="number" class="no-spin" id="text6" placeholder="XXXXXX0652" formControlName="mobile"
                (keydown)="validatePhoneNumber($event)"
                [ngClass]="{'ng_invalid': registrationFormControl.mobile.invalid && registrationFormControl.mobile.dirty,'ng_valid': registrationFormControl.mobile.valid}">

            </div>
          </div>
        </form>


        <form class="form-container " id="form2" [formGroup]="form" *ngIf="secondStep">
          <div class="form-row">
            <div class="input">
              <label>Employee ID </label>
              <input type="number" class="no-spin" id="text3" [(ngModel)]="currentEmployeeUid" formControlName="uid"
                pattern="^[^\s]+$" [disabled]="true" readonly>

            </div>
            <div class="input">
              <label>Date of Joining</label>
              <input type="date" id="text5" placeholder="DD/MM/YYYY" formControlName="dateOfJoining">

            </div>
          </div>
          <div class="form-row">
            <div class="input">
              <label>Location</label>
              <div class="dropdown_container" (mouseleave)="contentdropdown2 = false">
                <div class="dropdwon_select" (click)="dropdownOpen2()" id="slt1">

                  <input type="text" [(ngModel)]="Selectvariable2" formControlName="location" id="slt3"
                    placeholder="Select" readonly>
                  <span><i class="fa-sharp fa-solid fa-caret-down"></i></span>
                </div>
                <div class="select_content1" *ngIf="contentdropdown2" (mouseleave)="dropdownClose2()">
                  <ul>
                    <li *ngFor="let arr2 of array2; index as i" [class.select_active]="i === colorvariable2"
                      (click)="Changeselect2(arr2)">
                      {{arr2.name}}</li>
                  </ul>
                </div>
              </div>
            </div>
            <div class="input">
              <label>Timings</label>
              <div class="dropdown_container" (mouseleave)="contentdropdown3 = false">
                <div class="dropdwon_select" (click)="dropdownOpen3()" id="slt1">

                  <input type="text" [(ngModel)]="Selectvariable3" formControlName="timing" id="slt4"
                    placeholder="Select" readonly>
                  <span><i class="fa-sharp fa-solid fa-caret-down"></i></span>
                </div>
                <div class="select_content1" *ngIf="contentdropdown3" (mouseleave)="dropdownClose3()">
                  <ul>
                    <li *ngFor="let arr3 of array3; index as i" [class.select_active]="i === colorvariable3"
                      (click)="Changeselect3(arr3)">
                      {{arr3.name}}</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
          <div class="form-row">
            <div class="input">
              <label>CTC</label>
              <input type="text" id="text11" placeholder="8LPA" formControlName="ctc"
                [ngClass]="{'ng_invalid': registrationFormControl.ctc.invalid && registrationFormControl.ctc.dirty,'ng_valid': registrationFormControl.ctc.valid}">
            </div>
          </div>
        </form>
      </div>

      <div class="modal-footer">
        <button *ngIf="firstStep" (click)="onNextForm()" class="next-btn"
          [disabled]="!(form.value.name && form.value.job_type && form.value.designation && form.value.email && form.value.mobile && form.value.url)">
          Next </button>
        <button *ngIf="secondStep" (click)="onPreviousForm()" class="back-btn">Back</button>
        <button *ngIf="secondStep" type="submit" (click)="submit()" class="next-btn"
          [disabled]="!(this.form.controls.dateOfJoining.valid  && this.form.controls.ctc.valid && this.form.controls.location.valid && this.form.controls.timing.valid)">Done</button>
      </div>
    </div>
    <div class="modal-content2" *ngIf="fourthStep">
      <div class="modal-header2">
        <i class="fa-solid fa-circle-check" style="color: #3D9030; font-size: 60px;"></i>
      </div>
      <div class="modal-body2">
        <h3>New employee added successfully!</h3>
        <p>You can add more employees in a similar way
          and edit them when necessary.</p>
        <button class="done-btn2" (click)="closeModal()">Done</button>
      </div>
    </div>

    <div class="modal-content3" *ngIf="rowdelete">
      <div class="modal-body3">
        <h4>Do you really want to delete this employee?</h4>
        <div class="delete-btns">
          <button class="yes-btn" (click)="successdelete()">Yes</button>
          <button class="no-btn" (click)="closeModal2()">No</button>
        </div>

        <i class="fa-solid fa-xmark second" (click)="closeModal2()"></i>
      </div>
    </div>
    <div class="modal-content4" *ngIf="deletemessage">
      <div class="modal-header4">
        <img src="./assets/images/tick.png" alt="img">
      </div>
      <div class="modal-body4">
        <h3>Employee deleted successfully!</h3>
        <button class="done-btn2" (click)="closeModal3()">Done</button>
      </div>
    </div>

    <div class="modal-content5" *ngIf="importfile">
      <div class="modal-header5">
        <h4>Upload CSV</h4>
        <i class="fa-solid fa-xmark" (click)="closeFilepicker()"></i>
      </div>
      <hr>
      <div class="modal-body5">
        <div class="file-content">
          <img src="./assets/images/Vector (4).png" alt="">
          <h3>Select a CSV File to Upload</h3>
          <p>or drag and drop it here</p>
          <button class="choose" (click)="importFile()">Choose File</button>
          <!-- <button class="import" (click)="importFile()">Submit</button>  -->
          <input type="file" name="csv" (change)=" onFileSelectedrem($event)" formControlName="csv" accept=".csv, application/vnd.ms-excel" >
          <!-- <a (click)="fileInput.click()" class="choose">Choose File</a> -->
          <input type="text"  id="text18" readonly [value]="fileName1">
          <input type="file" #fileInput (change)="onFileSelected1($event)" formControlName="csv">
        </div>
        <h5>Download <a class="csv">Sample CSV File</a> for Reference</h5>
        <!-- <div class="custom-file-picker">
          <input type="text" placeholder="Add the file URL" id="text14" >
          <input type="file" >
          <a  class="choose">Choose File</a>

        </div> -->
        <div class="import-btns">
          <button class="can-btn" (click)="closeFilepicker()">Cancel</button>
          <button class="imp-btn" (click)="employeecsv()">Import</button>
        </div>
      </div>
    </div>
    <div class="modal-content6" *ngIf="csvadded">
      <div class="modal-header6">
        <img src="./assets/images/tick.png" alt="img">
      </div>
      <div class="modal-body6">
        <h3>Succesful</h3>
        <p>Csv File Imported Successfully!</p>
        <button class="done-btn2" (click)="closecsvadded()">Done</button>
      </div>
    </div>
  </div>
</div>
